# Домашнее задание к лекции 7 «Декораторы»

### Задача 1. Усовершенствуйте кэширующий декоратор

Напишите усовершенствованный кэширующий декоратор `cachingDecoratorNew`, аналогичный рассмотренному на лекции, таким образом, чтобы он кэшировал только последние 5 **различных** вызовов функции. То есть чтобы кэш мог хранить только 5 значений.

Для того, чтобы тесты выполнялись функция должна возвращать следующие строки(!) "Вычисляем: 10" для первого вызова (10 для примера) и "Из кэша: 10" для повторного. Подробнее смотрите в файле (tests.js)[./tests.js].

Рекомендуется параллельно выводить результаты в консоль, чтобы вам было удобнее отлаживать. 

```js
console.log("Вычисляем: " + result);
return "Вычисляем: " + result);
```

<details> 
  <summary>Подсказка 1</summary>
  Кэш можно сделать массивом объектов. Тогда внутри `wrapper` следует проверять, есть ли `hash(args)` в кэше и если нет, то либо добавлять новое кэшированное значение, либо, если таких значений уже 5, то добавлять одно в коне и удалять одно из начала.
  Проверить кэшированы ли `args` можно методом `find`.   
</details>

<details> 
  <summary>Подсказка 2</summary>
  
  Удаление и добавление в массив параметров можно реализовать с помощью методов массива `shift` и `push`.
</details>

```javascript
const addThree = (a, b, c) => (a + b + c); 
const upgradedAddThree = cachingDecoratorNew(addThree);
upgradedAddThree(1, 2, 3); // вычисляем: 6
upgradedAddThree(1, 2, 3); // из кэша: 6
upgradedAddThree(2, 2, 3); // вычисляем: 7
upgradedAddThree(3, 2, 3); // вычисляем: 8
upgradedAddThree(4, 2, 3); // вычисляем: 9
upgradedAddThree(5, 2, 3); // вычисляем: 10
upgradedAddThree(6, 2, 3); // вычисляем: 11   (при этом кэш для 1, 2, 3 уничтожается)
upgradedAddThree(1, 2, 3); // вычисляем: 6  (снова вычисляем, кэша нет)
```

### Задача 2. Фильтрация и преобразование массива

Усовершенствуйте рассмотренный на лекции debounce декоратор таким образом, чтобы первый его вызов происходил моментально а следующий не раньше чем через интервал времени, причем интервал должен задаваться в момент применения декоратора к функции. Такие декораторы называются "Leading edge" или "immediate" (немедленный). Они применяется если события, например отправка информации, происходит слишком часто. 
[![debounce-leading.png](https://i2.wp.com/css-tricks.com/wp-content/uploads/2016/04/debounce-leading.png)]


<details> 
  <summary>Подсказка 1</summary>
  Вызывайте переданную функцию немедленно и взводите флаг.    
</details>

<details> 
  <summary>Подсказка 2</summary>
  Используйте setTimeout для снятия флага и при каждом вызове проверяйте, взведен ли он.
</details>

```javascript
const sendSignal = () => console.log('Сигнал послан'); 
const upgradedSendSignal = debounceDecoratorNew(sendSignal,2000);
setTimeout(upgradedSendSignal()); // Сигнал отправлен
setTimeout(upgradedSendSignal(),300); // проигнорировано
setTimeout(upgradedSendSignal(),900); // проигнорировано
setTimeout(upgradedSendSignal(),1200); // проигнорировано
setTimeout(upgradedSendSignal(),2300); // Сигнал отправлен
setTimeout(upgradedSendSignal(),4400); // Сигнал отправлен
setTimeout(upgradedSendSignal(),4500); // проигнорировано
```
### Задача 3. Усовершенствуйте debounceDecoratorNew

Представьте ситуацию, что  пользователь очень часто нажимает отправить, при этом наш `debounce` декоратор отправляет сообщения не чаще чем раз в интервал времени, но мы хотим дополнительно знать, сколько всего раз была вызвана исходная функция. 
Усовершенствуйте декоратор из задания 2 таким образом, чтобы в свойстве `count` декорированной функции хранилось количество вызовов. Для решения используйте подход, который был применен в лекции для декоратора-шпиона. Усовершенствованный декоратор должен называться `debounceDecorator2`.

<details> 
  <summary>Подсказка 1</summary>
  Добавьте к обертке wrapper новое свойство count в котором храните количество вызовов.
</details>


```javascript
const sendSignal = () => console.log('Сигнал послан'); 
const upgradedSendSignal = debounceDecorator2(sendSignal,2000);
setTimeout(upgradedSendSignal()); // Сигнал отправлен
setTimeout(upgradedSendSignal(),300); // проигнорировано
setTimeout(upgradedSendSignal(),900); // проигнорировано
setTimeout(upgradedSendSignal(),1200); // проигнорировано
setTimeout(upgradedSendSignal(),2300); // Сигнал отправлен
setTimeout(upgradedSendSignal(),4400); // Сигнал отправлен
setTimeout(upgradedSendSignal(),4500); // проигнорировано
upgradedSendSignal.count; // 3
```


## Требования для выполнения домашней работы

- браузер;
- редактор кода, например [Sublime][1] или [Visual Studio Code][2];
- аккаунт на [GitHub][0] ([инструкция по регистрации на GitHub][3]);
- система контроля версий [Git][4], установленная локально ([инструкция по установке Git][5]).
- запуск всех тестов должен успешно выполнять все тесты:
  ![графическое представление](../Jasmine/results/sucessed_tasks3_1.png)

## Решение задач

1. Произведите [Fork](https://ru.wikipedia.org/wiki/Форк) репозитория с задачами (fork необходимо делать перед выполнением каждой домашней работы).
2. Перейдите в папку задания. `cd ./7.decorators`.
3. Откройте файл `task.js` в вашем редакторе кода и выполните задание.
4. Самостоятельно вызывать функции не требуется, если это не требуется по заданию.
5. Откройте файл `index.html` в вашем браузере и с помощью консоли DevTools убедитесь в правильности выводимых результатов.
6. Откройте файл `test-runer.html` в вашем браузере и убедитесь, что все тесты выполняются (на вкладке Spec List можно видеть какие тесты выполнились, а какие нет).
7. Добавьте файл `task.js` в индекс git с помощью команды `git add %file-path%`, где `%file-path%` - путь до целевого файла. `git add task.js`.
8. Сделайте коммит, используя команду `git commit -m '%comment%'`, где `%comment%` - это произвольный комментарий к вашему коммиту. `git commit -m 'first commit variables'`.
9. Опубликуйте код в репозиторий `homeworks` с помощью команды `git push -u origin master`.
10. Пришлите ссылку на репозиторий через личный кабинет на сайте [Нетологии][6].

[0]: https://github.com/
[1]: https://www.sublimetext.com/
[2]: https://code.visualstudio.com/
[3]: https://github.com/netology-code/guides/blob/master/git/github.md
[4]: https://git-scm.com/
[5]: https://github.com/netology-code/guides/blob/master/git/README.md
[6]: https://netology.ru/

_Никаких файлов прикреплять не нужно._

Любые вопросы по решению задач задавайте в Slack-канале.